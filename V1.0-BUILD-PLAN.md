# ğŸš€ PLAN DE BUILD V1.0 MVP - ULTRA CLEAN

**Objectif** : Plateforme web responsive pour concerts en live avec billetterie
**Timeline** : 3 jours (step by step)
**Status** : ğŸŸ¢ EN COURS

---

## ğŸ“‹ CHECKLIST COMPLÃˆTE

### âœ… Ã‰TAPE 1 : SETUP BASE (30 min)
- [x] CrÃ©er branche v1.0-mvp
- [x] CrÃ©er documents de plan
- [ ] Nettoyer package.json (garder seulement deps essentielles)
- [ ] CrÃ©er .env.example simplifiÃ©
- [ ] VÃ©rifier Next.js config minimal

### ğŸ”² Ã‰TAPE 2 : DATABASE ULTRA-SIMPLE (1h)
- [ ] CrÃ©er schema DB avec 5 tables SEULEMENT
- [ ] Appliquer dans Supabase
- [ ] Tester connexion
- [ ] CrÃ©er utilisateur test
- [ ] CrÃ©er Ã©vÃ©nement test

### ğŸ”² Ã‰TAPE 3 : AUTHENTIFICATION (1h)
- [ ] Setup Supabase Auth
- [ ] Page /auth/signin
- [ ] Page /auth/signup
- [ ] Middleware protection routes
- [ ] Test : signup â†’ login â†’ redirect

### ğŸ”² Ã‰TAPE 4 : HOMEPAGE & EVENTS (1h)
- [ ] Page / (homepage avec liste events)
- [ ] Page /events (tous les events)
- [ ] Composant EventCard simple
- [ ] Test : affichage correct

### ğŸ”² Ã‰TAPE 5 : PAGE Ã‰VÃ‰NEMENT (2h)
- [ ] Page /event/[id]
- [ ] Affichage infos Ã©vÃ©nement
- [ ] Bouton "Acheter un billet"
- [ ] Composant PurchaseButton
- [ ] Test : clic bouton fonctionne

### ğŸ”² Ã‰TAPE 6 : ACHAT DE BILLET (3h)
- [ ] API route /api/tickets/purchase
- [ ] IntÃ©gration Stripe Checkout
- [ ] Page success /ticket/success
- [ ] GÃ©nÃ©ration QR code
- [ ] Email confirmation (optionnel V1.0)
- [ ] Test : achat complet avec carte test Stripe

### ğŸ”² Ã‰TAPE 7 : DASHBOARD ARTISTE (2h)
- [ ] Page /artist/dashboard
- [ ] Afficher stats (billets vendus, revenu)
- [ ] Bouton "CrÃ©er un Ã©vÃ©nement"
- [ ] Formulaire crÃ©ation Ã©vÃ©nement
- [ ] Upload image (Supabase Storage)
- [ ] Test : crÃ©er event â†’ voir dans liste

### ğŸ”² Ã‰TAPE 8 : MES BILLETS (1h)
- [ ] Page /fan/tickets
- [ ] Afficher tous mes billets
- [ ] Afficher QR codes
- [ ] Test : aprÃ¨s achat, voir billet

### ğŸ”² Ã‰TAPE 9 : LIVE STREAMING (2h)
- [ ] Page /event/[id]/live
- [ ] Player YouTube embed
- [ ] Chat temps rÃ©el (Supabase Realtime)
- [ ] Composant ChatBox
- [ ] Test : envoyer message, voir en temps rÃ©el

### ğŸ”² Ã‰TAPE 10 : PAYOUT J+21 (2h)
- [ ] API route /api/cron/payouts
- [ ] Logique calcul 70/30
- [ ] Stripe payout vers artiste
- [ ] Test : simuler J+21, vÃ©rifier payout crÃ©Ã©

### ğŸ”² Ã‰TAPE 11 : POLISH & UI (2h)
- [ ] Design homepage propre
- [ ] Design responsive mobile
- [ ] Couleurs cohÃ©rentes
- [ ] Loading states
- [ ] Error handling

### ğŸ”² Ã‰TAPE 12 : TESTS COMPLETS (3h)
- [ ] ScÃ©nario 1 : Signup fan â†’ Acheter billet â†’ Voir QR code
- [ ] ScÃ©nario 2 : Signup artiste â†’ CrÃ©er event â†’ Voir stats
- [ ] ScÃ©nario 3 : Live â†’ Chat â†’ Messages temps rÃ©el
- [ ] ScÃ©nario 4 : Webhook Stripe â†’ Ticket crÃ©Ã©
- [ ] ScÃ©nario 5 : Payout J+21 â†’ Artiste reÃ§oit argent
- [ ] Fix tous les bugs trouvÃ©s

### ğŸ”² Ã‰TAPE 13 : DÃ‰PLOIEMENT (1h)
- [ ] VÃ©rifier .env production
- [ ] Deploy Vercel
- [ ] Configurer Stripe webhook production
- [ ] Tester en production
- [ ] CrÃ©er Ã©vÃ©nement David Guetta

---

## ğŸ¯ RÃˆGLES D'OR

### 1. UN FICHIER Ã€ LA FOIS
Ne jamais toucher 2 fichiers en mÃªme temps. Finir complÃ¨tement un fichier avant de passer au suivant.

### 2. TESTER APRÃˆS CHAQUE Ã‰TAPE
AprÃ¨s chaque Ã©tape, lancer `npm run dev` et vÃ©rifier que Ã§a marche.

### 3. COMMIT FRÃ‰QUENT
AprÃ¨s chaque Ã©tape validÃ©e, commit avec message clair :
```bash
git add .
git commit -m "feat(v1.0): step X - description"
git push
```

### 4. CODE MINIMAL
Si une ligne de code n'est pas ABSOLUMENT nÃ©cessaire, on ne l'Ã©crit pas.

### 5. ZÃ‰RO DÃ‰PENDANCE INUTILE
On installe SEULEMENT ce qu'on utilise vraiment.

### 6. COMMENTAIRES PARTOUT
Chaque fonction a un commentaire expliquant ce qu'elle fait.

### 7. TYPES STRICTS
Tout est typÃ© avec TypeScript. Pas de `any`.

### 8. ERROR HANDLING
Chaque API route a un try/catch complet.

---

## ğŸ“¦ DÃ‰PENDANCES ESSENTIELLES

```json
{
  "dependencies": {
    "next": "^14.2.0",
    "react": "^18.3.0",
    "react-dom": "^18.3.0",
    "@supabase/supabase-js": "^2.45.0",
    "@supabase/ssr": "^0.7.0",
    "stripe": "^14.25.0",
    "@stripe/stripe-js": "^4.10.0",
    "date-fns": "^3.6.0",
    "zod": "^3.23.0",
    "qrcode": "^1.5.3"
  },
  "devDependencies": {
    "typescript": "^5",
    "@types/node": "^20",
    "@types/react": "^18",
    "tailwindcss": "^3.4.0",
    "postcss": "^8",
    "autoprefixer": "^10"
  }
}
```

**C'EST TOUT.** Pas de @sentry, @resend, aws-sdk, etc. pour V1.0.

---

## ğŸ—„ï¸ STRUCTURE DE FICHIERS FINALE

```
vybzzz-v1.0/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx                    # Homepage
â”‚   â”œâ”€â”€ layout.tsx                  # Layout root
â”‚   â”œâ”€â”€ events/
â”‚   â”‚   â””â”€â”€ page.tsx                # Liste events
â”‚   â”œâ”€â”€ event/
â”‚   â”‚   â”œâ”€â”€ [id]/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx            # Page Ã©vÃ©nement
â”‚   â”‚   â”‚   â””â”€â”€ live/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx        # Live + chat
â”‚   â”œâ”€â”€ artist/
â”‚   â”‚   â””â”€â”€ dashboard/
â”‚   â”‚       â””â”€â”€ page.tsx            # Dashboard artiste
â”‚   â”œâ”€â”€ fan/
â”‚   â”‚   â””â”€â”€ tickets/
â”‚   â”‚       â””â”€â”€ page.tsx            # Mes billets
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ signin/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx            # Login
â”‚   â”‚   â””â”€â”€ signup/
â”‚   â”‚       â””â”€â”€ page.tsx            # Signup
â”‚   â”œâ”€â”€ ticket/
â”‚   â”‚   â””â”€â”€ success/
â”‚   â”‚       â””â”€â”€ page.tsx            # Success aprÃ¨s achat
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ tickets/
â”‚       â”‚   â””â”€â”€ purchase/
â”‚       â”‚       â””â”€â”€ route.ts        # Achat billet
â”‚       â”œâ”€â”€ events/
â”‚       â”‚   â””â”€â”€ create/
â”‚       â”‚       â””â”€â”€ route.ts        # CrÃ©er Ã©vÃ©nement
â”‚       â”œâ”€â”€ chat/
â”‚       â”‚   â”œâ”€â”€ send/
â”‚       â”‚   â”‚   â””â”€â”€ route.ts        # Envoyer message
â”‚       â”‚   â””â”€â”€ messages/
â”‚       â”‚       â””â”€â”€ [eventId]/
â”‚       â”‚           â””â”€â”€ route.ts    # Get messages
â”‚       â”œâ”€â”€ stripe/
â”‚       â”‚   â””â”€â”€ webhook/
â”‚       â”‚       â””â”€â”€ route.ts        # Webhook Stripe
â”‚       â””â”€â”€ cron/
â”‚           â””â”€â”€ payouts/
â”‚               â””â”€â”€ route.ts        # Payout J+21
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ EventCard.tsx               # Card Ã©vÃ©nement
â”‚   â”œâ”€â”€ PurchaseButton.tsx          # Bouton achat
â”‚   â”œâ”€â”€ ChatBox.tsx                 # Chat temps rÃ©el
â”‚   â”œâ”€â”€ VideoPlayer.tsx             # Player YouTube
â”‚   â”œâ”€â”€ TicketQRCode.tsx            # Affichage QR code
â”‚   â””â”€â”€ ArtistEventForm.tsx         # Form crÃ©ation event
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts               # Client Supabase (browser)
â”‚   â”‚   â””â”€â”€ server.ts               # Client Supabase (server)
â”‚   â”œâ”€â”€ stripe.ts                   # Config Stripe
â”‚   â”œâ”€â”€ utils.ts                    # Fonctions utilitaires
â”‚   â””â”€â”€ constants.ts                # Constantes (70/30, etc.)
â”‚
â”œâ”€â”€ types/
â”‚   â””â”€â”€ database.ts                 # Types Supabase auto-gÃ©nÃ©rÃ©s
â”‚
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ schema-v1-mvp.sql           # Schema DB (dÃ©jÃ  crÃ©Ã© âœ…)
â”‚
â”œâ”€â”€ public/
â”‚   â””â”€â”€ .well-known/                # Domaine verification (dÃ©jÃ  crÃ©Ã© âœ…)
â”‚
â”œâ”€â”€ middleware.ts                   # Auth middleware
â”œâ”€â”€ next.config.js                  # Config Next.js minimal
â”œâ”€â”€ tailwind.config.js              # Config Tailwind
â”œâ”€â”€ .env.example                    # Env vars template
â”œâ”€â”€ .gitignore
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md

TOTAL : ~25 fichiers
```

---

## ğŸ¨ DESIGN SYSTEM SIMPLE

### Couleurs
```typescript
// Palette VyBzzZ
PRIMARY: '#FF6B35'      // Orange vif
SECONDARY: '#004E89'    // Bleu foncÃ©
ACCENT: '#F7931E'       // Orange clair
SUCCESS: '#22C55E'      // Vert
ERROR: '#EF4444'        // Rouge
BACKGROUND: '#FFFFFF'   // Blanc
TEXT: '#1F2937'         // Gris foncÃ©
```

### Typographie
```
Font : Inter (Google Fonts)
H1 : 48px bold
H2 : 36px bold
H3 : 24px semibold
Body : 16px regular
Small : 14px regular
```

### Spacing
```
xs: 4px
sm: 8px
md: 16px
lg: 24px
xl: 32px
2xl: 48px
```

---

## âš™ï¸ VARIABLES D'ENVIRONNEMENT (SIMPLIFIÃ‰ES)

```bash
# Supabase (3 variables SEULEMENT)
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# Stripe (3 variables SEULEMENT)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=

# App (1 variable)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Cron (1 variable)
CRON_SECRET=

TOTAL : 8 variables (vs 32+ avant)
```

---

## ğŸ§ª TESTS MANUELS (CHECKLIST)

### Test 1 : Signup & Login
```
1. Va sur /auth/signup
2. CrÃ©e compte : email + password
3. VÃ©rifie redirection vers /events
4. Logout
5. Va sur /auth/signin
6. Login avec mÃªmes credentials
7. VÃ©rifie redirection vers /events
âœ… Pass si tout fonctionne
```

### Test 2 : CrÃ©er Ã‰vÃ©nement (Artiste)
```
1. Signup avec role "artist"
2. Va sur /artist/dashboard
3. Click "CrÃ©er un Ã©vÃ©nement"
4. Remplis formulaire :
   - Titre : "Test Concert"
   - Date : Demain 20h
   - Prix : 10â‚¬
   - CapacitÃ© : 100
   - YouTube URL : https://youtube.com/watch?v=test
5. Upload une image
6. Click "Publier"
7. VÃ©rifie redirection vers dashboard
8. VÃ©rifie Ã©vÃ©nement apparaÃ®t
âœ… Pass si Ã©vÃ©nement crÃ©Ã©
```

### Test 3 : Acheter Billet (Fan)
```
1. Logout
2. Signup avec role "fan"
3. Va sur /events
4. Click sur Ã©vÃ©nement "Test Concert"
5. Click "Acheter un billet"
6. Remplis Stripe Checkout :
   - Carte : 4242 4242 4242 4242
   - Expiry : 12/34
   - CVC : 123
7. Click "Payer"
8. VÃ©rifie redirection vers /ticket/success
9. VÃ©rifie billet apparaÃ®t
10. VÃ©rifie QR code gÃ©nÃ©rÃ©
âœ… Pass si billet achetÃ© et QR visible
```

### Test 4 : Voir Billets AchetÃ©s
```
1. Va sur /fan/tickets
2. VÃ©rifie billet "Test Concert" apparaÃ®t
3. VÃ©rifie QR code visible
4. Screenshot QR code (pour scanner plus tard)
âœ… Pass si billet visible
```

### Test 5 : Dashboard Artiste Mis Ã  Jour
```
1. Logout fan
2. Login artiste (crÃ©ateur de l'Ã©vÃ©nement)
3. Va sur /artist/dashboard
4. VÃ©rifie stats :
   - Billets vendus : 1
   - Revenu brut : 10â‚¬
   - Ta part (70%) : 7â‚¬
   - Plateforme (30%) : 3â‚¬
âœ… Pass si stats correctes
```

### Test 6 : Live + Chat
```
1. Login en tant que fan
2. Va sur /event/[id]/live
3. VÃ©rifie player YouTube s'affiche
4. Envoie message dans chat : "Hello!"
5. Ouvre onglet incognito
6. Login autre user
7. Va sur mÃªme /event/[id]/live
8. VÃ©rifie message "Hello!" visible
9. Envoie message : "Hi back!"
10. VÃ©rifie dans premier onglet : "Hi back!" apparaÃ®t
âœ… Pass si chat temps rÃ©el fonctionne
```

### Test 7 : Webhook Stripe
```
1. Va sur Stripe Dashboard
2. Va dans Webhooks
3. Envoie un test event : payment_intent.succeeded
4. VÃ©rifie dans Supabase : nouveau ticket crÃ©Ã©
5. VÃ©rifie tickets_sold incrÃ©mentÃ©
âœ… Pass si webhook traitÃ© correctement
```

### Test 8 : Payout J+21
```
1. Va sur /api/cron/payouts?secret=CRON_SECRET
2. VÃ©rifie dans console : "No payouts due yet"
3. Dans Supabase, mets event.event_date Ã  J-22
4. Re-call /api/cron/payouts?secret=CRON_SECRET
5. VÃ©rifie dans console : "Payout created"
6. VÃ©rifie dans Stripe : Transfer crÃ©Ã©
7. VÃ©rifie dans Supabase : payout status = paid
âœ… Pass si payout crÃ©Ã© et transfÃ©rÃ©
```

---

## ğŸ› BUGS COURANTS Ã€ Ã‰VITER

### Bug #1 : Supabase RLS bloque les requÃªtes
**SymptÃ´me** : 403 Forbidden sur toutes les requÃªtes
**Fix** : VÃ©rifier que les policies RLS sont bien appliquÃ©es

### Bug #2 : Stripe webhook fail signature
**SymptÃ´me** : Webhook events Ã©chouent avec "Invalid signature"
**Fix** : VÃ©rifier STRIPE_WEBHOOK_SECRET est correct

### Bug #3 : Chat ne met pas Ã  jour en temps rÃ©el
**SymptÃ´me** : Messages n'apparaissent pas automatiquement
**Fix** : VÃ©rifier Supabase Realtime est activÃ© sur table chat_messages

### Bug #4 : QR code ne gÃ©nÃ¨re pas
**SymptÃ´me** : Erreur lors de l'achat de billet
**Fix** : Installer package qrcode : `npm install qrcode @types/qrcode`

### Bug #5 : Images ne s'uploadent pas
**SymptÃ´me** : Erreur lors de la crÃ©ation d'Ã©vÃ©nement
**Fix** : VÃ©rifier bucket Supabase Storage crÃ©Ã© et RLS configurÃ©

---

## ğŸ“Š MÃ‰TRIQUES DE SUCCÃˆS V1.0

### Technique
- [ ] 0 erreur TypeScript
- [ ] 0 erreur ESLint
- [ ] Build Next.js rÃ©ussit
- [ ] Tous les 8 tests manuels passent

### Fonctionnel
- [ ] Achat de billet fonctionne 10/10 fois
- [ ] Chat temps rÃ©el fonctionne
- [ ] Dashboard artiste affiche stats correctes
- [ ] Payout J+21 se dÃ©clenche automatiquement

### Performance
- [ ] Page load < 3 secondes
- [ ] Responsive mobile parfait
- [ ] Lighthouse score > 80

### Business
- [ ] Ã‰vÃ©nement David Guetta crÃ©Ã©
- [ ] Au moins 1 billet test achetÃ©
- [ ] PrÃªt pour le 31 dÃ©cembre

---

**DerniÃ¨re mise Ã  jour** : Maintenant
**Status** : ğŸš€ ON COMMENCE !
